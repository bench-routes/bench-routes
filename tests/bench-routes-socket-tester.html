<!DOCTYPE html>
<html lang="en">
   <head>
      <style>
         .controls {
         margin: 40px;
         }
      </style>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="X-UA-Compatible" content="ie=edge">
      <!-- Bootstrap css -->
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"/>
      <title>Document</title>
   </head>
   <body>
      <div class="container">
         <div class="btn-group controls" role="group" aria-label="Button group with nested dropdown">
            <!-- Ping -->
            <div class="btn-group" role="group">
               <button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
               Ping controls
               </button>
               <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                  <button class="dropdown-item btn" onclick="startPing()" href="#">Start Ping</button>
                  <button class="dropdown-item btn" onclick="stopPing()" href="#">Stop Ping</button>
               </div>
            </div>
            <!-- FloodPing controls -->
            <div class="btn-group" role="group">
               <button id="btnGroupDrop2" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
               FloodPing controls
               </button>
               <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                  <button class="dropdown-item btn" onclick="startFloodPing()" href="#">Start FloodPing</button>
                  <button class="dropdown-item btn" onclick="stopFloodPing()" href="#">Stop FloodPing</button>
               </div>
            </div>
            <!-- Jitter controls -->
            <div class="btn-group" role="group">
               <button id="btnGroupDrop3" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
               Jitter controls
               </button>
               <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                  <button class="dropdown-item btn" onclick="startJitter()" href="#">Start Jitter</button>
                  <button class="dropdown-item btn" onclick="stopJitter()" href="#">Stop Jitter</button>
               </div>
            </div>
            <!-- Req res controls -->
            <div class="btn-group" role="group">
               <button id="btnGroupDrop4" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
               Req-res controls
               </button>
               <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                  <button class="dropdown-item btn" onclick="startReqResMonitoring()" href="#">Start Req-Res</button>
                  <button class="dropdown-item btn" onclick="stopReqResMonitoring()" href="#">Stop Req-Res</button>
               </div>
            </div>
         </div>
         <!-- Route configuration controls -->
         <div class="btn-group controls" role="group" aria-label="Button group with nested dropdown">
            <!-- Get route details -->
            <div class="btn-group" role="group">
               <button id="btnGroupDrop5" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
               Route details
               </button>
               <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                  <button class="dropdown-item btn" onclick="routeDetails()" href="#">Get route details</button>
               </div>
            </div>
         </div>
         <!-- Querrier controls -->
         <div class="btn-group controls" role="group" aria-label="Button group with nested dropdown">
            <!-- Ping Querrier -->
            <div class="btn-group" role="group">
               <button id="btnGroupDrop6" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
               Ping Querier
               </button>
               <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                  <button class="dropdown-item btn" onclick="Qping()" href="#">Query Ping</button>
               </div>
            </div>
            <!-- Flood Ping querier -->
            <div class="btn-group" role="group">
               <button id="btnGroupDrop7" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
               Flood Ping Querier
               </button>
               <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                  <button class="dropdown-item btn" onclick="QFloodPing()" href="#">Query Flood Ping</button>
               </div>
            </div>
            <!-- Jitter querier -->
            <div class="btn-group" role="group">
               <button id="btnGroupDrop8" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
               Jitter Querier
               </button>
               <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                  <button class="dropdown-item btn" onclick="Qjitter()" href="#">Query Jitter</button>
               </div>
            </div>
            <!-- Req res querier -->
            <div class="btn-group" role="group">
               <button id="btnGroupDrop9" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
               Req res Querier
               </button>
               <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                  <button class="dropdown-item btn" onclick="Qreqresdelay()" href="#">Query Req-res</button>
               </div>
            </div>
         </div>
         <h3>Logger: <button class="btn btn-primary" onclick="clearLogs()">clear this page</button></h3>
         <ul id="logs" style="overflow-y: scroll; height:400px; width: 1000px;">
         </ul>
      </div>
      <!-- Jquery and bootstrap js -->
      <script
         src="https://code.jquery.com/jquery-3.4.1.min.js"
         integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
         crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
      <script>
         // Logger handlers
         var logArea = document.querySelector('ul')
         const log = (message) => {
         	var li = document.createElement('li')
         	li.innerHTML = message
         	logArea.appendChild(li)
         }
         const startService = (serviceName) => {
         	var li = document.createElement('li')
         	li.innerHTML = "Starting service for " + serviceName + "..."
         	logArea.appendChild(li)
         }
         const stopService = (serviceName) => {
         	var li = document.createElement('li')
         	li.innerHTML = "Stopping service for " + serviceName + "..."
         	logArea.appendChild(li)
         }
         const clearLogs = () => {
         	logArea.innerHTML = ''
         }
         
         // Start socket
         let socket = new WebSocket("ws://localhost:9090/websocket")
         log("<i>Waiting for connection</i>")
         
         // Socket handlers
         socket.onopen = () => {
         	log("<b>Connected to bench-routes</b>")
         	socket.send("hi from ui")
         }
         
         socket.onmessage = m => {
         	console.log('message received as ', m)
         }
         
         socket.onclose = () => {
         	console.warn("connection closed")
         }
         
         // Module handlers
         function startPing() {
         	startService("ping module")
         	socket.send("force-start-ping")
         }
         function stopPing() {
         	stopService("ping module")
         	socket.send("force-stop-ping")
         }
         function startFloodPing() {
         	startService("flood-ping module")
         	socket.send("force-start-flood-ping")
         }
         function stopFloodPing() {
         	stopService("flood-ping module")
         	socket.send("force-stop-flood-ping")
         }
         function startJitter() {
         	startService("jitter module")
         	socket.send("force-start-jitter")
         }
         function stopJitter() {
         	stopService("jitter module")
         	socket.send("force-stop-jitter")
         }
         const startReqResMonitoring = () => {
         	startService("request-response module")
         	socket.send("force-start-req-res-monitoring")
         }
         const stopReqResMonitoring = () => {
         	stopService("request-response module")
         	socket.send("force-stop-req-res-monitoring")
         }
         function routeDetails() {
         	log("Getting route details for you...")
         	socket.send("route-details")
         }
         function Qping() {
         	log("Querying for ping data...")
         	let url = {
         		url: "google.co.in"
         	};
         	socket.send("Qping-route " + JSON.stringify(url));
         }
         function QFloodPing() {
         	log("Querying for flood-ping data...")
         	let url = {
         		url: "google.co.in"
         	};
         	socket.send("Qflood-ping-route " + JSON.stringify(url));
         }
         function Qjitter() {
         	log("Querying for jitter data...")
         	let url = {
         		url: "google.co.in"
         	};
         	socket.send("Qjitter-route " + JSON.stringify(url));
         }
         const Qreqresdelay = () => {
         	log("Querying for request-response data...")
         	let route = {
         		url: "https://www.google.co.in",
         		method: "GET"
         	};
         	socket.send("Qrequest-response-delay "+ JSON.stringify(route))
         }
      </script>
   </body>
</html>